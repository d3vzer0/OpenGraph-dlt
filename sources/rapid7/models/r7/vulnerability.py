from pydantic import BaseModel
from datetime import datetime
from typing import Optional


class AssetVulnerability(BaseModel):
    id: str
    instances: int
    since: datetime
    status: str


class CVSS(BaseModel):
    vector: str
    exploitScore: float
    impactScore: float
    score: float


class Description(BaseModel):
    html: Optional[str] = None
    text: Optional[str] = None


class Vulnerability(BaseModel):
    id: str
    title: str
    added: datetime
    modified: datetime
    categories: Optional[list[str]] = None
    v2: Optional[CVSS] = None
    v3: Optional[CVSS] = None
    denialOfService: bool
    description: Description
    exploits: int
    malwareKits: int
    fixAvailable: bool
    severity: str
    severityScore: float
    riskScore: float
    severityScore: float
    published: str
